<script type="lazyload2" data-src="https://cdn.hextom.com/js/quickannouncementbar.js?shop=sheertexsheers.myshopify.com"></script>

{% comment %} Solvy integration script {% endcomment %}
{% if settings.enable_solvy_script %}
  <script type="lazyload2" data-src="https://cdn.solvvy.com/deflect/customization/sheertex/solvvy.js" async></script>
{% endif %}

<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TPDV3NN"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->

{% if settings.enable_currencies %}
    <script type="lazyload2" data-src="/services/javascripts/currencies.js"></script>
    {% unless shop.enabled_currencies.size > 1 %}      
        <script type="lazyload2" data-src="{{ 'currencies.jquery.min.js' | asset_url | split: '?' | first }}" defer="defer"></script>
        <script crossorigin="anonymous" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    {% endunless %}
{% endif %}

<script type="lazyload2" data-src="{{ 'countrySelect.min.js' | asset_url }}"></script>

{% comment %} n.b. was at top of `<body>` {% endcomment %}
{% if settings.animate_page_transitions %}
  <script type="text/javascript">window.setTimeout(function() { document.body.className += " loaded"; }, 25);</script>
{% endif %}

{%- if settings.cart_type == 'drawer' -%}
  {%- include 'ajax-cart-template' -%}
  <script type="text/javascript">     
     // i18n for checkout button
      let checkoutBtnLocalisationTimerId = window.setInterval(() => {        
        window.langify && window.langify.locale.iso_code == 'fr' && window.jQuery("h2.tdf_rec_h2") && window.jQuery("h2.tdf_rec_h2").text("Faites provision en plus articles essentiels") && clearInterval(checkoutBtnLocalisationTimerId);
      }, 500);  
    
      // send event to HotJar when checkout button clicked
      const intervalId = window.setInterval(() => { 
        const checkoutButtonElement = document.querySelector('button[name=checkout]');
        if (checkoutButtonElement) {
          checkoutButtonElement.addEventListener('click', () => {
            window.hj && window.hj('event', 'checkout');
          });         
          clearInterval(intervalId);
        }
       }, 500);    
    
  </script>
{%- endif -%}

{% comment %} Kustomer {% endcomment %}
<script type="lazyload2"
  data-src="https://cdn.kustomerapp.com/chat-web/widget.js"
  data-kustomer-api-key='eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjYxODE5OGVmZTk1MWEwNDM0YTZmNTNiMiIsInVzZXIiOiI2MTgxOThlYTkwYjJlZmU4Y2U1OTkyNzMiLCJvcmciOiI1ZWI1NWU0OGU0NjhiMjAwMWE3NjIzZTUiLCJvcmdOYW1lIjoic2hlZXJ0ZXgiLCJ1c2VyVHlwZSI6Im1hY2hpbmUiLCJwb2QiOiJwcm9kMSIsInJvbGVzIjpbIm9yZy50cmFja2luZyJdLCJhdWQiOiJ1cm46Y29uc3VtZXIiLCJpc3MiOiJ1cm46YXBpIiwic3ViIjoiNjE4MTk4ZWE5MGIyZWZlOGNlNTk5MjczIn0.7REtTQEyJswdEnL7IqxP7We6xxwSJy0TC258zKZc9Zw'
></script>
<script>
  Kustomer.start({
    brandId: '5eb55e4ca35999001932a330'
  });
</script>

<script type="lazyload2">
  window.jQuery(document).ready(function() {

  function $import(src, attrs){
   var scriptElem = document.createElement('script');
    scriptElem.setAttribute('src',src);    
    scriptElem.setAttribute('type','text/javascript');

    if (attrs) {
      for (var key in attrs) {
        scriptElem.setAttribute(key,attrs[key]);
      }
    }

    document.getElementsByTagName('head')[0].appendChild(scriptElem);
  }

  function $runWhenDefined(condition, callback) {        
    if(!condition()) {
       window.setTimeout(() => $runWhenDefined(condition, callback), 500); 
    } else {
      callback();
    }
  } 
        
     $import("https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js", { defer: "defer" });
  $runWhenDefined(() => { return window.lozad },
  () => {
    const observer = window.lozad(); // lazy loads elements with default selector as '.lozad'
    observer.observe();      
  })

    $import("https://a.klaviyo.com/media/js/onsite/onsite.js", { defer: "defer" });
    

    $runWhenDefined(() => { return window.klaviyo }, () => {
      var klaviyo = window.klaviyo;
      klaviyo.init({
        account: "Qi48e3",
        list: 'LfnKub',
        platform: "shopify"
      });

       klaviyo.enable("backinstock",{ 
    trigger: {
      product_page_text: "Notify Me When Available",
      product_page_class: "btn",
      product_page_text_align: "center",
      product_page_margin: "0px",
      replace_anchor: false
    },
    modal: {
     headline: "{product_name}",
     body_content: "Register to receive a notification when this item comes back in stock.",
     email_field_label: "Email",
     button_label: "Notify me when available",
     subscription_success_label: "You're in! We'll let you know when it's back.",
     footer_content: '',
     drop_background_color: "#000",
     background_color: "#fff",
     text_color: "#222",
     button_text_color: "#000",
     button_background_color: "#ddff98",
     close_button_color: "#ccc",
     error_background_color: "#fcd6d7",
     error_text_color: "#C72E2F",
     success_background_color: "#d3efcd",
     success_text_color: "#1B9500",
    }
  }); 
  });
    })
    </script>
    <script type="lazyload2">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)}})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

sxScript("https://unpkg.com/web-vitals@1.1.0/dist/web-vitals.umd.js", function() {
  function sendToGTM(stat) {
    ga('send', 'event', {
      eventCategory: 'Web Vitals',
      eventAction: stat.name,
      eventLabel: stat.id,
      {% comment %}
      // ga requires integers, so convert deltas from fractions -> millis
      {% endcomment %}
      eventValue: Math.round(stat.name == 'CLS' ? stat.delta * 1000 : stat.delta),
      nonInteraction: true,
      transport: 'beacon',
    });
  }
  webVitals.getCLS(sendToGTM);
  webVitals.getFID(sendToGTM);
  webVitals.getLCP(sendToGTM);
  webVitals.getFCP(sendToGTM);
  webVitals.getTTFB(sendToGTM);
});

</script>

{% include 'script-tags', layout: 'theme' %}
